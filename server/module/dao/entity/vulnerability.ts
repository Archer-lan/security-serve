import {BaseEntity,Entity,Column,Id,JoinColumn,ManyToOne,EntityProxy} from 'relaen';
import {Assets} from './assets';
import {Assessment} from './assessment';
import {Threaten} from './threaten';

@Entity('t_vulnerability')
export class Vulnerability extends BaseEntity{
	@Id()
	@Column({
		name:'id',
		type:'int',
		nullable:false
	})
	public id:number;

	@ManyToOne({entity:'Assets'})
	@JoinColumn({
		name:'asset_id',
		refName:'id',
		nullable:false
	})
	public assets:Assets;

	@Column({
		name:'type',
		type:'string',
		nullable:false,
		length:255
	})
	public type:string;

	@Column({
		name:'value',
		type:'int',
		nullable:false
	})
	public value:number;

	@ManyToOne({entity:'Assessment'})
	@JoinColumn({
		name:'assessment_id',
		refName:'id',
		nullable:false
	})
	public assessment:Assessment;

	@ManyToOne({entity:'Threaten'})
	@JoinColumn({
		name:'threaten_id',
		refName:'id',
		nullable:false
	})
	public threaten:Threaten;

	@Column({
		name:'status',
		type:'int',
		nullable:false
	})
	public status:number;

	constructor(idValue?:number){
		super();
		this.id = idValue;
	}
	public async getAssets():Promise<Assets>{
		return this['assets']?this['assets']:await EntityProxy.get(this,'assets');
	}
	public async getAssessment():Promise<Assessment>{
		return this['assessment']?this['assessment']:await EntityProxy.get(this,'assessment');
	}
	public async getThreaten():Promise<Threaten>{
		return this['threaten']?this['threaten']:await EntityProxy.get(this,'threaten');
	}
}